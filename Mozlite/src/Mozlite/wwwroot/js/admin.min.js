(function(n){n.fn.clickToggle=function(t,i){return this.each(function(){var r=!1;n(this).bind("click",function(){return r?(r=!1,i.apply(this,arguments)):(r=!0,t.apply(this,arguments))})})};n.fn.jsTarget=function(){var t=n(this.js("target"));return t.length>0?t:this};n.fn.dset=function(n,t){var i=this.data(n);return i?this.data(n):(i=t(),this.data(n,i),i)};n.fn.exec=function(t){this.length>0&&this.each(function(){var i=n(this);i.hasClass("no-js")||t(i)})};window.$call=function(n){var t=window,u,r,i;n=n.split(".");for(u in n)t=t[n[u]];if(typeof t=="function"){for(r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);return t.apply(null,r)}return null};window.$exec=function(t,i,r){var u=n("["+t+"]",r);u.length>0&&u.each(function(){var r=n(this),u=r.attr(t);r.hasClass("no-js")||u==="no-js"||i(r,u)})};window.$alert=function(t,i,r){var u,f,e;(typeof t=="object"&&t&&(i=t.type,t=t.message),t)&&(u=n(document.body).dset("alert",function(){return n('<div class="js-alert modal fade"><div class="modal-dialog"><div class="modal-content"><div class="modal-body" style="padding: 50px 30px 30px;"><div class="col-sm-2"><i style="font-size: 50px;"><\/i><\/div> <span class="col-sm-10" style="line-height: 26px; padding-left: 0;"><\/span><\/div><div class="modal-footer"><button type="button" class="btn btn-primary"><i class="fa fa-check"><\/i> 确定<\/button><\/div><\/div><\/div><\/div>').appendTo(document.body)}),f=u.find(".modal-body"),i=i||"warning",i==="success"?f.attr("class","modal-body row text-success").find("i").attr("class","fa fa-check"):f.attr("class","modal-body row text-"+i).find("i").attr("class","fa fa-warning"),f.find("span").html(t),e=u.find("button").attr("class","btn btn-"+i),r?e.attr("onclick","location.href=location.href;").removeAttr("data-dismiss"):e.attr("data-dismiss","modal").removeAttr("onclick"),u.modal("show"))};window.$ajax=function(t,i,r,u){n("#js-loading").fadeIn();n.ajax({url:t,data:i,dataType:"JSON",type:"POST",success:function(t){n("#js-loading").fadeOut();var i=t.data&&r;t.message&&t.type&&$alert(t.message,t.type,t.type==="success"&&!i);i&&r(t.data)},error:function(t){if(n("#js-loading").fadeOut(),t.status===401){$alert('需要登陆才能够执行此操作！<a href="/login?returnurl='+location.pathname+'">点击登陆...<\/a>',"warning");return}u?u(t):document.write(t.responseText)}})};window.$submit=function(t,i,r){var u=n(t),f=u.find("button[type=submit]").attr("disabled","disabled"),e=f.find("i.fa"),o=e.attr("class");e.attr("class","fa fa-spinner fa-spin");n.ajax({type:"POST",url:u.attr("action"),contentType:!1,processData:!1,data:new FormData(t),success:function(n){if(f.removeAttr("disabled").find("i.fa").attr("class",o),n.message){var t=u.find(".modal-alert span.errmsg");t.length>0?t.html(n.message).parent().attr("class","modal-alert alert alert-"+n.type).show():$alert(n.message,n.type,n.type==="success"&&!i)}n.type==="success"&&(i?i(n):location.href=location.href)},error:function(n){if(f.removeAttr("disabled").find("i.fa").attr("class",o),n.status===401){$alert('需要登陆才能够执行此操作！<a href="/login">点击登陆...<\/a>',"warning");return}r&&r(n)}})};n.fn.js=function(n,t){return t?this.attr("js-"+n,t):this.attr("js-"+n)};n.fn.createObjectURL=function(){return!this.is("input")||this.attr("type")!=="file"?null:navigator.userAgent.indexOf("MSIE")>0?this.val():window.createObjectURL?window.createObjectURL(this[0].files[0]):window.URL?window.URL.createObjectURL(this[0].files[0]):window.webkitURL?window.webkitURL.createObjectURL(this[0].files[0]):null};n.fn.jsModal=function(t,i,r){var u=this,f;if(t=t||u.js("url"),!t){alert("js-url属性不能为空！");return}f=u.dset("js-modal",function(){return n('<div class="js-modal modal fade"><div>').appendTo($container).data("source",u.jsTarget())});f.load(t,function(){var n=f.find("form");n.attr("action")||n.attr("action",t);n.attr("onsubmit")||(i=i||u.js("func"),i?(f.data("func",i),n.attr("onsubmit","$(this).jsModalSubmit("+i+");return false;")):n.attr("onsubmit","$(this).jsModalSubmit();return false;"),(r||u.js("upload")==="true")&&n.attr("enctype","multipart/form-data"))}).modal("show")};window.$modalInsert=function(t,i,r){if(i.url){i=i.url;t.val(i);r.modal("hide");return}r=n(t).parents(".js-modal");t=r.data("source");var u=r.data("func");u&&u!=="$modalInsert"?$call(u,t,i,r):t&&t.val(i);r.modal("hide")};n.fn.jsModalSubmit=function(n){var t=this;$submit(this[0],function(i){if(n=n||t.parents(".js-modal").data("func"),n){var r=t.parents(".js-modal");n(r.data("source"),i.data||i,r)}else setTimeout(function(){location.href=location.href},1e3)},function(n){t.find(".modal-body").html(n.responseText)})};n(document).ready(function(){window.$container=n("#modal-container");window.$container.length===0&&(window.$container=document.body);$exec("js-browser",function(n,t){n.on(t,function(){var t=n.js("url")||n.attr("href"),i;return t||(t="/browser/",t+=n.js("mt")+"/",t+=n.js("id"),i=n.js("dir"),i&&(t+="-"+i)),n.jsModal(t,"$modalInsert",!0),!1})});$exec("js-modal",function(n,t){n.css("cursor","pointer");n.on(t,function(){return n.jsModal(n.js("url")||n.attr("href")),!1})});$exec("_toggle",function(t,i){t.hover(function(){n(this).jsTarget().toggleClass(i)},function(){n(this).jsTarget().toggleClass(i)})});$exec("_focus",function(t,i){t.focusin(function(){n(this).jsTarget().toggleClass(i)}).focusout(function(){n(this).jsTarget().toggleClass(i)})});$exec("_click",function(t,i){t.click(function(){n(this).jsTarget().toggleClass(i)})});$exec("_hover",function(t){t.mouseenter(function(t){var u=n(this),i=u.target(),r=u.attr("_hover");i.addClass(r);i.mouseleave(function(){i.removeClass(r)}).click(function(n){n.stopPropagation()});n(document).one("click",function(){i.removeClass(r)});t.stopPropagation()})});$exec("_href",function(n,t){n.css("cursor","pointer").click(function(){n.attr("target")==="_blank"?window.open(t):location.href=t})});window.onscroll=function(){$exec("js-scroll",function(t,i){var u=t.dset("scrollTop",function(){return t.offset().top}),r=t.jsTarget();n(document.body).scrollTop()>u?i===":visible"?r.show():(i=t.dset("class",function(){for(var u=[],t=i.split(" "),n=0;n<t.length;n++)r.hasClass(t[n])||u.push(t[n]);return u.join(" ")}),t.data("class",i),r.addClass(i)):i===":visible"?r.hide():r.removeClass(t.data("class"))})};n("[data-toggle=dropdown]").exec(function(n){n.js("event")==="hover"?n.dropdownHover():n.dropdown()});$exec("js-action",function(n,t){n.on("click",function(){var u=n.js("confirm"),i,r;(!u||confirm(u))&&(i=n.js("success"),i&&(i=function(n){$call(i,n)}),r=n.js("error"),r&&(r=function(n){$call(r,n)}),$ajax(t,{id:n.js("value")},i,r))})})})})(jQuery),function(n){n(function(){var t;if(n("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal-green",radioClass:"iradio_minimal-green",increaseArea:"20%"}),t=n(".wrapper-main"),!(t.length<=0)){var e=t.find(".toolbar").find(".btn[js-enabled]").each(function(){var t=n(this).js("enabled");(t==="1"||t==="1+")&&n(this).addClass("disabled")}),r=t.find(".list-header").find(":checkbox"),u=t.find(".list-body").find(":checkbox"),i=0,f=u.length;r.on("ifChecked ifUnchecked",function(n){n.type==="ifChecked"?u.iCheck("check"):u.iCheck("uncheck")});u.on("ifChecked ifUnchecked",function(u){var o,s;u.type==="ifChecked"?(i++,i!==f||r.prop("checked")||(r.attr("checked","checked").prop("checked","checked"),r.iCheck("update")),n(this).parents(".list-view-item").addClass("active")):(i--,i!==f&&r.prop("checked")&&(r.removeAttr("checked").removeProp("checked"),r.iCheck("update")),n(this).parents(".list-view-item").removeClass("active"));e.each(function(){var t=n(this).js("enabled");i>1?t==="1+"?n(this).removeClass("disabled"):n(this).addClass("disabled"):i===1?t==="1"||t==="1+"?n(this).removeClass("disabled"):n(this).addClass("disabled"):n(this).addClass("disabled")});i>0?(t.find(".list-header").find("ul.list-cols").hide(),o=t.find(".list-header").find(".list-checked").show().find(".text"),o.html(o.js("text").replace("$size",i)),i===f&&(s=t.find(".list-header").find(".list-checked").find(":checkbox"),s.attr("checked","checked").prop("checked","checked"),s.iCheck("update"))):(t.find(".list-header").find("ul.list-cols").show(),t.find(".list-header").find(".list-checked").hide())});n(".list-view-item").click(function(){var t=n(this).find(":checkbox");t.is(":checked")||t.iCheck("check")});window.checkeds=function(){var t=[];return u.filter(":checked").each(function(){t.push(n(this).val())}),t}}})}(jQuery);$(function(){window.onload=window.onresize=function(){$(".scrolly").height($(document).height()-$(".scrolly").offset().top)}});